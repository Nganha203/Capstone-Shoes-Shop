import{j as e,p as y,r as P,M as _,m as C,t as L,v as o,F as u,A as V}from"./index-4920cf17.js";import{S,c as z,a as F}from"./index.esm-f3000cd0.js";import{S as A}from"./index-9734b30a.js";import{u as O,b as R,c as T,g as q}from"./user.service-b3b31845.js";import"./config.service-f74b9060.js";const D="_wrap_7ftsg_1",M="_title_7ftsg_6",$="_form_action_7ftsg_50",G="_form_action__login_7ftsg_55",H="_line_7ftsg_82",U="_menu_7ftsg_86",K="_active_7ftsg_105",B="_cart_7ftsg_123",r={wrap:D,title:M,"profile-detail":"_profile-detail_7ftsg_16","profile-detail__img":"_profile-detail__img_7ftsg_23","profile-detail__input":"_profile-detail__input_7ftsg_36",form_action:$,form_action__login:G,line:H,menu:U,"menu-item":"_menu-item_7ftsg_94",active:K,cart:B,"cart-title":"_cart-title_7ftsg_127","cart-table":"_cart-table_7ftsg_138"},I="_page_1bdz8_1",J="_disable_1bdz8_23",Q="_active_1bdz8_29",W="_dot_1bdz8_33",a={page:I,"page-button":"_page-button_1bdz8_6",disable:J,active:Q,dot:W};function X(k){const{selectedPage:i,totalItem:c,setSelectedPage:f}=k,m=t=>{let s=i+t;s<1&&(s=1),s>c&&(s=c),f(s)},d=t=>{f(t)},w=()=>{const t=[];if(i===1?t.push(e.jsx("div",{className:a["page-button"]+" "+a.disable,onClick:()=>{m(-1)},children:"<"},-1)):t.push(e.jsx("div",{className:a["page-button"],onClick:()=>{m(-1)},children:"<"},-1)),c<=5)for(let s=1;s<=c;s++)i===s?t.push(e.jsx("div",{className:a["page-button"]+" "+a.active,onClick:()=>d(s),children:s},s)):t.push(e.jsx("div",{className:a["page-button"],onClick:()=>d(s),children:s},s));else{if(i-1<=2)for(let s=1;s<i;s++)t.push(e.jsx("div",{className:a["page-button"],onClick:()=>d(s),children:s},s));else t.push(e.jsx("div",{className:a["page-button"],onClick:()=>d(1),children:1},1)),t.push(e.jsx("div",{className:a["page-button"]+" "+a.dot,children:"..."},"...1")),t.push(e.jsx("div",{className:a["page-button"],onClick:()=>d(i-1),children:i-1},i-1));if(t.push(e.jsx("div",{className:a["page-button"]+" "+a.active,onClick:()=>d(i),children:i},i)),c-i>2)t.push(e.jsx("div",{className:a["page-button"],onClick:()=>d(i+1),children:i+1},i+1)),t.push(e.jsx("div",{className:a["page-button"]+" "+a.dot,children:"..."},"...2")),t.push(e.jsx("div",{className:a["page-button"],onClick:()=>d(c),children:c},c));else for(let s=i+1;s<=c;s++)t.push(e.jsx("div",{className:a["page-button"],onClick:()=>d(s),children:s},s))}return i===c?t.push(e.jsx("div",{className:a["page-button"]+" "+a.disable,onClick:()=>{m(1)},children:">"},c+1)):t.push(e.jsx("div",{className:a["page-button"],onClick:()=>{m(1)},children:">"},c+1)),t};return e.jsx(e.Fragment,{children:e.jsx("div",{className:a.page,children:w()})})}const Y=/(84|0[3|5|7|8|9])+([0-9]{8})\b/,Z=z({name:F().required(),email:F().email("Email không đúng định dạng").required("Email không được bỏ trống."),phone:F().matches(Y,"Số điện thoại không đúng định dạng").required("Số điện thoại không được bỏ trống."),password:F().min(5,"Password phải lớn hơn 5 ký tự.").max(20,"Password phải nhỏ hơn 20 ký tự.")});function le(){const k=y(),[i,c]=P.useState([]),[f,m]=P.useState(1),[d,w]=P.useState(0),t=O({initialValues:{avatar:"",name:"",email:"",gender:!0,phone:"",password:""},validationSchema:Z,onSubmit:async b=>{try{const{name:n,email:N,gender:g,phone:x,password:h}=b,p={name:n,email:N,gender:g,phone:x};let l=!0,j=!0;const v=await R(p);if((v==null?void 0:v.data.content)!==_.success&&(l=!1),h){const E=await T(h);(E==null?void 0:E.data.content)!==_.success&&(j=!1)}if(j&&l){alert(_.success);return}if(!l){alert(_.fail_update_profile);return}j||alert(_.fail_update_password)}catch(n){console.log(n)}}});P.useEffect(()=>{(async()=>{C(V)||k(L.login);const n=await q();if((n==null?void 0:n.data.message)!==_.success)return;const{avatar:N,email:g,gender:x,phone:h,name:p}=(n==null?void 0:n.data.content)??{};t.setFieldValue(o.avatar,N),t.setFieldValue(o.email,g),t.setFieldValue(o.gender,x),t.setFieldValue(o.phone,h),t.setFieldValue(o.name,p);const l=n==null?void 0:n.data.content.ordersHistory;l.sort((j,v)=>new Date(v.date).getTime()-new Date(j.date).getTime()),c(()=>l),w(Math.ceil(l.length/2))})()},[]);const s=(b,n)=>{const g=(b-1)*2,x=n.slice(g,g+2);let h=0;return x.map(p=>(h=0,e.jsxs("div",{className:r.cart,children:[e.jsxs("p",{className:r["cart-title"],children:["+ Orders have been placed on"," ",p.date.toLocaleString().replace("T"," ")]}),e.jsxs("table",{className:r["cart-table"],children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"image"}),e.jsx("th",{children:"name"}),e.jsx("th",{children:"price"}),e.jsx("th",{children:"quantity"}),e.jsx("th",{children:"total"})]})}),e.jsx("tbody",{children:p.orderDetail.map(l=>(h+=l.price*l.quantity,e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:l.image,alt:"..."})}),e.jsx("td",{children:l.name}),e.jsx("td",{children:l.price}),e.jsx("td",{children:e.jsx("span",{children:l.quantity})}),e.jsx("td",{children:(l.price*l.quantity).toLocaleString()})]},l.name)))})]}),e.jsxs("div",{children:["Total: ",h.toLocaleString()]})]},p.id)))};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:r.wrap,children:[e.jsx("div",{className:r.title,children:"Profile"}),e.jsxs("div",{className:r["profile-detail"],children:[e.jsx("div",{className:r["profile-detail__img"],children:e.jsx("img",{src:t.values.avatar,alt:"..."})}),e.jsxs("form",{onSubmit:t.handleSubmit,className:r["profile-detail__input"],children:[e.jsx(S,{showEye:!1,placeholder:u.Email,type:o.email,title:o.email,getFieldProps:t.getFieldProps(o.email),touched:t.touched.email,error:t.errors.email,disabled:!0}),e.jsx(S,{showEye:!1,placeholder:u.Name,type:o.text,title:u.Name,getFieldProps:t.getFieldProps(o.name),touched:t.touched.name,error:t.errors.name}),e.jsx(S,{showEye:!1,placeholder:u.Phone,type:o.text,title:u.Phone,getFieldProps:t.getFieldProps(o.phone),touched:t.touched.phone,error:t.errors.phone}),e.jsx(S,{showEye:!1,placeholder:u.Password,type:o.password,title:u.Password,getFieldProps:t.getFieldProps(o.password)}),e.jsxs("div",{className:r.form_action,children:[e.jsx("button",{type:"submit",className:r.form_action__login,children:"Submit"}),e.jsx(A,{value:t.values.gender,setFieldValue:t.setFieldValue})]})]})]}),e.jsx("div",{className:r.line}),e.jsxs("div",{className:r.menu,children:[e.jsx("div",{className:r["menu-item"]+" "+r.active,children:"Order history"}),e.jsx("div",{className:r["menu-item"],children:"Favorite"})]}),s(f,i),d>1&&e.jsx(X,{totalItem:d,selectedPage:f,setSelectedPage:m})]})})}export{le as default};
